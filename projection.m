P1 = rand(8,1);
P2 = rand(8,1);
P11 = P1/norm(P1);
P = P1*P1';
P22 = P2 - P*P2;
P22 = P22/norm(P22);
P = P + P2*P2';
P = P';
Q = eye(8) - P;
c = ones(8,1);
A = [1,0,0,0,0,0,0,0;0,2,0,0,0,0,0,0;0,0,3,0,0,0,0,0;0,0,0,4,0,0,0,0;0,0,0,0,5,0,0,0;0,0,0,0,0,6,0,0;0,0,0,0,0,0,7,0;0,0,0,0,0,0,0,8];
A = -A;
E = expm(A);
g = [1,0.5,2,1,1,3,0,0.25];
gnp = g*(P*E*E+(Q*E)*P*E+(Q*E)*(Q*E)*P);
gnq = g*(Q*E)*(Q*E)*Q;
gn = gnp+gnq;
Gn = gn*c
disp(norm(gnq*c-Gn)/norm(Gn))